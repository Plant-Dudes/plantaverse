import{_ as c,r as i,o as l,a as d,b as e,d as o,w as h,F as p,e as t,f as a}from"./app.2bf926e2.js";const f={},u=t("The theme provides progressive web app support "),g=e("sup",{class:"footnote-ref"},[e("a",{href:"#footnote1"},"[1]"),e("a",{class:"footnote-anchor",id:"footnote-ref1"})],-1),m=t(" via builtin "),_={href:"https://vuepress-theme-hope.github.io/v2/pwa/",target:"_blank",rel:"noopener noreferrer"},b=e("code",null,"vuepress-plugin-pwa2",-1),w=t(", and it's disabled by default."),y={class:"custom-container info"},v=e("p",{class:"custom-container-title"},"Info",-1),k=e("p",null,[e("code",null,"vuepress-theme-hope"),t(" provides the "),e("code",null,"pwa"),t(" options in "),e("code",null,"themeConfig.plugins"),t(" as plugin options to "),e("code",null,"vuepress-plugin-pwa2"),t(".")],-1),S=t("You can set "),W=e("code",null,"pwa: true",-1),C=t(" to enable the plugin with default options. "),x=a('<h2 id="content-caching-and-updating" tabindex="-1"><a class="header-anchor" href="#content-caching-and-updating" aria-hidden="true">#</a> Content caching and updating</h2><p>Service Worker <sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup> (SW for short) is mainly used to cache and proxy site content.</p><p>This plugin will automatically register Service Woker through <code>workbox-build</code>.</p><p>To better control what the Service Worker can pre-cache, the plugin provides the following configurations.</p><p>If you are an advanced user, you can also directly set <code>generateSwConfig</code> in <code>themeConfig.plugins.pwa</code> to pass options to <code>workbox-build</code>.</p><h3 id="default-cache" tabindex="-1"><a class="header-anchor" href="#default-cache" aria-hidden="true">#</a> Default cache</h3><p>By default, the plugin will pre-cache all files related to the site: <code>**/*.{html,js,css,svg}</code></p><p>At the same time, the plugin will cache font files: <code>**/*.{woff,woff2,eot,ttf,otf}</code>.</p><h3 id="cache-control" tabindex="-1"><a class="header-anchor" href="#cache-control" aria-hidden="true">#</a> Cache Control</h3><p>Based on the requirement of installable <sup class="footnote-ref"><a href="#footnote3">[3]</a><a class="footnote-anchor" id="footnote-ref3"></a></sup>, the plugin provides related options for cache control.</p><h4 id="picture-cache" tabindex="-1"><a class="header-anchor" href="#picture-cache" aria-hidden="true">#</a> Picture Cache</h4><p>You can cache site pictures by setting the <code>cachePic</code> option to <code>true</code>.</p><p>If your site is not large and the pictures are mostly critical descriptions, and hope to be displayed in offline mode, it is recommended to set this option to <code>true</code>.</p><div class="custom-container info"><p class="custom-container-title">Image recognition</p><p>We recognize images by file extension. Any files ending with <code>.png</code>, <code>.jpg</code>, <code>.jpeg</code>, <code>.gif</code>, <code>.bmp</code>, <code>.webp</code> will be regarded as images.</p></div><h4 id="html-cache" tabindex="-1"><a class="header-anchor" href="#html-cache" aria-hidden="true">#</a> HTML cache</h4><p>When your site is too large, you can set <code>themeConfig.pwa.cacheHTML</code> to <code>false</code> to cache only the homepage and 404 error pages.</p><div class="custom-container tip"><p class="custom-container-title">Why can these be removed?</p><p>Though VuePress generates HTML files through SSR<sup class="footnote-ref"><a href="#footnote4">[4]</a><a class="footnote-anchor" id="footnote-ref4"></a></sup> for all pages, these files are mainly used for SEO<sup class="footnote-ref"><a href="#footnote5">[5]</a><a class="footnote-anchor" id="footnote-ref5"></a></sup> and allow you to directly configure the backend without SPA<sup class="footnote-ref"><a href="#footnote6">[6]</a><a class="footnote-anchor" id="footnote-ref6"></a></sup> Visit any link.</p><p>VuePress is essentially a SPA. This means that you can enter from the homepage to access all pages normally only caching the homepage.</p><p>When your site has a large number of pages or content, and the volume is too large after including HTML files, you can consider setting this option to <code>false</code>, which can reduce the volume by about 40%. The disadvantage is that users can only enter through the homepage and then navigate to the corresponding page in an offline environment. Direct access to a link will prompt a web page error.</p></div><h4 id="size-control" tabindex="-1"><a class="header-anchor" href="#size-control" aria-hidden="true">#</a> Size control</h4><p>To prevent large files from being included in the pre-cache list, any files larger than 2MB or pictures larger than 1MB will be deleted.</p><p>You can customize the maximum file size of the cache (unit: KB) with the <code>maxSize</code> option in <code>themeConfig.plugins.pwa</code>, or change the size limit of the picture (unit: KB) with <code>maxPicSize</code> in <code>themeConfig.plugins.pwa</code>.</p><h3 id="update-popup" tabindex="-1"><a class="header-anchor" href="#update-popup" aria-hidden="true">#</a> Update popup</h3><p>We provide an update popup when new content is successfully downloaded.</p><div class="custom-container tip"><p class="custom-container-title">Custom popup</p><p>If you are not satisfied with the default popup component, you can write component and replace it by yourself. To do that, You need to register your popup component globally and pass the name of the component to the <code>popupComponent</code> option in <code>themeConfig.plugins.pwa</code>.</p></div><h2 id="manifest-file-generation" tabindex="-1"><a class="header-anchor" href="#manifest-file-generation" aria-hidden="true">#</a> Manifest file generation</h2><p>To ensure the installability of PWA, the site needs to generate a manifest file and declare a valid manifest file address <sup class="footnote-ref"><a href="#footnote7">[7]</a><a class="footnote-anchor" id="footnote-ref7"></a></sup> through <code>link</code>.</p><p>The plugin will automatically generate the Manifest file <code>manifest.webmanifest</code> for you in the output directory, and will also add the manifest address statement to each HTML <code>&lt;head&gt;</code>.</p><p>If you already have a <code>manifest.webmanifest</code> or <code>manifest.json</code> in <code>.vuepress/public</code>, the plugin will read and merge it into the final manifest.</p><h3 id="automatic-generation" tabindex="-1"><a class="header-anchor" href="#automatic-generation" aria-hidden="true">#</a> Automatic generation</h3><p>The plugin will use the information from the VuePress plugin API and set the fallback for fields in manifest as much as possible. So you don\u2019t need to set most of the manifest fields.</p><p>If the following fields are not set, they will try to fallback to the following preset value in order.</p><table><thead><tr><th>Options</th><th>Default value</th></tr></thead><tbody><tr><td>name</td><td><code>siteConfig.title</code> || <code>siteConfig.locales[&#39;/&#39;].title</code> || <code>&#39;Site&#39;</code></td></tr><tr><td>short_name</td><td><code>siteConfig.title</code> || <code>siteConfig.locales[&#39;/&#39;].title</code> || <code>&#39;Site&#39;</code></td></tr><tr><td>description</td><td><code>siteConfig.description</code> || <code>siteConfig.locales[&#39;/&#39;].description</code> || <code>&#39;A site built with vuepress&#39;</code></td></tr><tr><td>lang</td><td><code>siteConfig.locales[&#39;/&#39;].lang</code> || <code>themeConfig.locales[&#39;/&#39;].lang</code> || <code>&quot;en-US&quot;</code></td></tr><tr><td>start_url</td><td><code>siteConfig.base</code></td></tr><tr><td>scope</td><td><code>siteConfig.base</code></td></tr><tr><td>display</td><td><code>&quot;standalone&quot;</code></td></tr><tr><td>theme_color</td><td><code>&quot;#46bd87&quot;</code></td></tr><tr><td>background_color</td><td><code>&#39;#ffffff&#39;</code></td></tr><tr><td>orientation</td><td><code>&#39;portrait-primary&#39;</code></td></tr><tr><td>prefer_related_applications</td><td><code>false</code></td></tr></tbody></table>',31),P=t("For complete configuration items, please see "),A={href:"https://github.com/vuepress-theme-hope/vuepress-theme-hope/blob/main/packages/pwa2/src/shared/manifest.ts",target:"_blank",rel:"noopener noreferrer"},T=t("Manifest Type Definition File"),M=t("."),B=a('<h3 id="manual-configuration" tabindex="-1"><a class="header-anchor" href="#manual-configuration" aria-hidden="true">#</a> Manual configuration</h3><p>You can manually specify the contents of the manifest in the <code>manifest</code> option in <code>themeConfig.plugins.pwa</code>.</p><div class="custom-container tip"><p class="custom-container-title">Priority</p><p><code>manifest</code> option in <code>themeConfig.plugins.pwa</code> has the highest priority, followed by manifest files that may exist in the <code>public</code> folder.</p></div><p><strong>You should at least set a valid icon through <code>manifest.icons</code> in <code>themeConfig.plugins.pwa</code> or other icon related options in the PWA plugin.</strong></p><div class="custom-container warning"><p class="custom-container-title">Note</p><p>The installability <sup class="footnote-ref"><a href="#footnote3">[3:1]</a><a class="footnote-anchor" id="footnote-ref3:1"></a></sup> specification requires at least one valid icon to be declared in the manifest.</p><p>So if you do not configure <code>manifest.icons</code> in <code>themeConfig.plugins.pwa</code>, visitors can only enjoy the offline accessibility brought by the Service Worker cache, while cannot install your site as a PWA.</p><p>Besides the plugin does not process anything in the manifest by default, but outputs them as-is. This means that if you plan to deploy to a subdirectory, you should append the url prefix to manifest Urls yourself.</p><p>But, if everything you need is all under base folder, you can set <code>appendBase: true</code> in plugin options to let the plugin append <code>base</code> to any Urls in</p></div><h2 id="other-options" tabindex="-1"><a class="header-anchor" href="#other-options" aria-hidden="true">#</a> Other options</h2><p>The plugin also provides other PWA-related options, such as Microsoft tile icon and color settings, Apple icon and so on.</p>',7),I=t("You can set them as needed. For detailed options, please see "),q=t("Plugin Config"),z=t("."),F=e("h2",{id:"further-reading",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#further-reading","aria-hidden":"true"},"#"),t(" Further Reading")],-1),L=e("p",null,"For more details, please see:",-1),N={href:"https://vuepress-theme-hope.github.io/v2/pwa/",target:"_blank",rel:"noopener noreferrer"},E=t("PWA plugin docs"),V={href:"https://web.dev/progressive-web-apps/",target:"_blank",rel:"noopener noreferrer"},Y=t("Google PWA"),H={href:"https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps",target:"_blank",rel:"noopener noreferrer"},O=t("MDN PWA"),R={href:"https://w3c.github.io/manifest/",target:"_blank",rel:"noopener noreferrer"},j=t("W3C Manifest Specification"),D=e("hr",{class:"footnotes-sep"},null,-1),U={class:"footnotes"},K={class:"footnotes-list"},G=a('<li id="footnote1" class="footnote-item"><p><strong>PWA introduction</strong></p><p>PWA, full name Progressive Web app. PWA standard is stipulated by W3C.</p><p>It allows sites to install the site as an App on supported platform through a browser that supports this feature. <a href="#footnote-ref1" class="footnote-backref">\u21A9\uFE0E</a></p></li><li id="footnote2" class="footnote-item"><p><strong>Service Worker Introduction</strong></p><ol><li><p>The Service Worker will get and cache all the files registered in it during the registration process.</p></li><li><p>After the registration complete, the Service Worker is activated, and starts to proxy and control all your requests.</p></li><li><p>Whenever you want to initiate an access request through the browser, the Service Worker will check whether it exists in its own cache list, if it exists, it will directly return the cached result, otherwise it will call its own fetch method to get it. You can use a custom fetch method to fully control the result of the request for resources in the web page, such as providing a fallback web page when offline.</p></li><li><p>Every time the user reopens the site, the Service Worker will request to the link when it was registered. If a new version of Service Woker is detected, it will update itself and start caching the list of resources registered in the new Service Worker . After the content update is successfully obtained, the Service Worker will trigger the <code>update</code> event. The user can be notified through this event, for example, a pop-up window will be displayed in the lower right corner, prompting the user that new content is available and allowing the user to trigger an update.</p></li></ol><a href="#footnote-ref2" class="footnote-backref">\u21A9\uFE0E</a></li><li id="footnote3" class="footnote-item"><p><strong>Installable</strong></p><p>To let the site be registered as a PWA, the site needs to successfully register a valid service worker by itself, and at the same time add a valid manifest file and declare it.</p><p>Each platform or browser has requirements for the size of the Service Worker cache. When the file size of the Service Worker cache is too large, the site will be marked as not installable. For Safari, the threshold is 50 MB, a few browsers will set less or more values (30MB, 70MB, 80MB), and Chrome will mark the threshold at 100 MB.</p><p>The manifest file should contain at least <code>name</code> (or <code>short_name</code>) <code>icons</code> <code>start_url</code></p><div class="custom-container note"><p class="custom-container-title">Note</p><p>Starting from Chrome 93, Service Woker must contain effective fetch events to control offline requests.</p><p>However, currently the plugin does not contain relevant processing logic by default, so on Android devices with Chrome 93 or later, the site will not pop up an installation prompt.</p></div><a href="#footnote-ref3" class="footnote-backref">\u21A9\uFE0E</a> <a href="#footnote-ref3:1" class="footnote-backref">\u21A9\uFE0E</a></li><li id="footnote4" class="footnote-item"><p><strong>SSR</strong>: <strong>S</strong>erver <strong>S</strong>ide <strong>R</strong>endering, <a href="#footnote-ref4" class="footnote-backref">\u21A9\uFE0E</a></p></li><li id="footnote5" class="footnote-item"><p><strong>SEO</strong>: <strong>S</strong>earch <strong>E</strong>ngine <strong>O</strong>ptimization. <a href="#footnote-ref5" class="footnote-backref">\u21A9\uFE0E</a></p></li><li id="footnote6" class="footnote-item"><p><strong>SPA</strong>: <strong>S</strong>ingle <strong>P</strong>age <strong>A</strong>pplication, most of them only have the homepage, and use history mode to handle routing instead of actually navigating between pages. <a href="#footnote-ref6" class="footnote-backref">\u21A9\uFE0E</a></p></li>',6),J={id:"footnote7",class:"footnote-item"},Q=e("p",null,[e("strong",null,"Manifest File")],-1),X=e("p",null,"The manifest file uses the JSON format and is responsible for declaring various information of the PWA, such as name, description, icon, and shortcut actions.",-1),Z=e("p",null,"In order for your site to be registered as a PWA, you need to meet the basic specifications of the manifest to make the browser consider the site as an installable PWA and allow users to install it.",-1),$={class:"custom-container info"},ee=e("p",{class:"custom-container-title"},"Info",-1),te=t("For Manifest standards and specifications, please see "),oe={href:"https://w3c.github.io/manifest/",target:"_blank",rel:"noopener noreferrer"},ne=t("W3C Manifest"),ie=e("a",{href:"#footnote-ref7",class:"footnote-backref"},"\u21A9\uFE0E",-1);function ae(se,re){const n=i("ExternalLinkIcon"),s=i("Badge"),r=i("RouterLink");return l(),d(p,null,[e("p",null,[u,g,m,e("a",_,[b,o(n)]),w]),e("div",y,[v,k,e("p",null,[S,W,C,o(s,{text:"Not recommanded",type:"warning"})])]),x,e("p",null,[P,e("a",A,[T,o(n)]),M]),B,e("p",null,[I,o(r,{to:"/config/plugins/pwa.html"},{default:h(()=>[q]),_:1}),z]),F,L,e("ul",null,[e("li",null,[e("a",N,[E,o(n)])]),e("li",null,[e("a",V,[Y,o(n)])]),e("li",null,[e("a",H,[O,o(n)])]),e("li",null,[e("a",R,[j,o(n)])])]),D,e("section",U,[e("ol",K,[G,e("li",J,[Q,X,Z,e("div",$,[ee,e("p",null,[te,e("a",oe,[ne,o(n)])])]),ie])])])],64)}var le=c(f,[["render",ae]]);export{le as default};
